<!DOCTYPE html>
<script>
    /* bind 函数 */
    // 通过闭包调用 call || apply 可以实现 bind 函数
    // apply 数组参数； call() 参数用逗号分隔 == bind()()
    // 乞丐版
    Function.prototype.mybind = function (context, ...preArgs) {
        return (...args) => this.call(context, ...preArgs, ...args);
    };
    // 进阶版
    Function.prototype.mybind = function (context) {
        if (typeof this !== "function") {
            throw new TypeError("Error");
        }
        let _this = this;
        let arg = [...arguments].slice(1);
        return function F() {
            // 处理函数使用new的情况
            if (this instanceof F) {
                return new _this(...arg, ...arguments);
            } else {
                return _this.apply(context, arg.concat(...arguments));
            }
        };
    };

    /* apply 函数 */
    Function.prototype.myapply = function (context) {
        if (typeof this !== "function") {
            throw new TypeError("not funciton");
        }
        context = context || window;
        context.fn = this;
        let result;

        if (arguments[1]) {
            result = context.fn(...arguments[1]);
        } else {
            result = context.fn();
        }

        delete context.fn;

        return result;
    };
</script>
